@model List<TourWebApp.Data.Models.DonDatTour>
@{
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

<h3 class="fw-bold mb-4">üì¶ Qu·∫£n l√Ω ƒë∆°n ƒë·∫∑t tour</h3>

<!-- B·ªô l·ªçc -->
<form method="get" class="mb-3">
    <select name="trangThai" class="form-select w-auto d-inline-block">
        <option value="TatCa">T·∫•t c·∫£</option>
        <option value="ChoDuyet" selected="@(ViewBag.TrangThai=="ChoDuyet")">Ch·ªù duy·ªát</option>
        <option value="DaDuyet" selected="@(ViewBag.TrangThai=="DaDuyet")">ƒê√£ duy·ªát</option>
        <option value="DaHuy" selected="@(ViewBag.TrangThai=="DaHuy")">ƒê√£ h·ªßy</option>
        <option value="DaThanhToan" selected="@(ViewBag.TrangThai=="DaThanhToan")">ƒê√£ thanh to√°n</option>
        <option value="ChuaThanhToan" selected="@(ViewBag.TrangThai=="ChuaThanhToan")">Ch∆∞a thanh to√°n</option>
    </select>
    <button class="btn btn-primary">L·ªçc</button>
</form>

<table class="table table-bordered align-middle">
    <thead class="table-dark">
        <tr>
            <th>M√£ booking</th>
            <th>Kh√°ch h√†ng</th>
            <th>Tour</th>
            <th>Ng√†y ƒë·∫∑t</th>
            <th>Ti·ªÅn</th>
            <th>Tr·∫°ng th√°i</th>
            <th width="140">Thao t√°c</th>
        </tr>
    </thead>

    <tbody>
        @foreach (var d in Model)
        {
            <tr>
                <td>@d.MaBooking</td>
                <td>@d.IdTaiKhoanNavigation.HoTen</td>
                <td>@d.IdTourNavigation.TenTour</td>
                <td>@d.NgayDat.ToString("dd/MM/yyyy")</td>
                <td>@String.Format("{0:#,0}ƒë", d.TongTien)</td>
                <td>
                        @* ∆Øu ti√™n tr·∫°ng th√°i THANH TO√ÅN *@
                        @if (d.DaThanhToan)
                        {
                            <span class="badge bg-success">ƒê√£ thanh to√°n</span>
                        }
                        else if (d.TrangThai == "DaHuy")
                        {
                            <span class="badge bg-danger">ƒê√£ h·ªßy</span>
                        }
                        else if (d.HanThanhToan != null && d.HanThanhToan < DateTime.Now)
                        {
                            <span class="badge bg-secondary">H·∫øt h·∫°n thanh to√°n</span>
                        }
                        else
                        {
                            <span class="badge bg-warning text-dark">Ch·ªù thanh to√°n</span>
                        }
                </td>

                <td>
                    <a asp-action="ChiTiet" asp-route-id="@d.IdDon" class="btn btn-primary btn-sm">
                        Xem
                    </a>
                    @if (!d.DaThanhToan)
                        {
                            <form asp-action="Xoa"
                                method="post"
                                class="d-inline"
                                onsubmit="return confirm('X√≥a ƒë∆°n ch∆∞a thanh to√°n n√†y?')">

                                <input type="hidden" name="id" value="@d.IdDon" />
                                <button class="btn btn-danger btn-sm">
                                    X√≥a
                                </button>
                            </form>
                        }
                </td>
            </tr>
        }
    </tbody>
</table>
