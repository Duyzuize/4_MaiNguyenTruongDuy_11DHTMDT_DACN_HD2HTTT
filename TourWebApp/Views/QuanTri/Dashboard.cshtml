@{
    Layout = "_LayoutAdmin";
}

<link rel="stylesheet" href="~/css/dashboard-admin.css" />

<h3 class="mb-4 fw-bold">
    üìä T·ªïng quan h·ªá th·ªëng HappyTrip
</h3>

<!-- LOADING -->
<div id="loadingScreen">
    <div class="spinner"></div>
    <span>ƒêang t·∫£i d·ªØ li·ªáu...</span>
</div>

<div class="row g-3 mb-4">

    <div class="col-md-3">
        <div class="card stat-card bg-blue text-white shadow-sm">
            <div class="card-body d-flex justify-content-between align-items-center">
                <div>
                    <small class="text-white-50">T·ªïng tour</small>
                    <h2 class="fw-bold mb-0 counter" data-count="@ViewBag.TongTour">0</h2>
                </div>
                <i class="fa fa-map-location-dot fa-2x"></i>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card stat-card bg-green text-white shadow-sm">
            <div class="card-body d-flex justify-content-between align-items-center">
                <div>
                    <small class="text-white-50">Tour ƒëang b√°n</small>
                    <h2 class="fw-bold mb-0 counter" data-count="@ViewBag.TourDangBan">0</h2>
                </div>
                <i class="fa fa-check-circle fa-2x"></i>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card stat-card bg-gray text-white shadow-sm">
            <div class="card-body d-flex justify-content-between align-items-center">
                <div>
                    <small class="text-white-50">Tour ng∆∞ng b√°n</small>
                    <h2 class="fw-bold mb-0 counter" data-count="@ViewBag.TourNgungBan">0</h2>
                </div>
                <i class="fa fa-pause-circle fa-2x"></i>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card stat-card bg-red text-white shadow-sm">
            <div class="card-body d-flex justify-content-between align-items-center">
                <div>
                    <small class="text-white-50">ƒê∆°n ƒë·∫∑t tour</small>
                    <h2 class="fw-bold mb-0 counter" data-count="@ViewBag.TongDon">0</h2>
                </div>
                <i class="fa fa-receipt fa-2x"></i>
            </div>
        </div>
    </div>

</div>

<div class="row mb-4">
    <div class="col-md-6">
        <div class="card shadow-sm p-3 chart-card">
            <h6 class="fw-bold mb-3">üìà T√¨nh tr·∫°ng tour</h6>

            <div class="chart-wrapper">
                <canvas id="chartTrangThai"
                        data-dangban="@ViewBag.TourDangBan"
                        data-ngungban="@ViewBag.TourNgungBan"></canvas>
            </div>
        </div>
    </div>
</div>
<div class="row mb-4">
    <!-- BI·ªÇU ƒê·ªí C·ªòT -->
    <div class="col-md-6">
        <div class="card shadow-sm p-3 chart-card">
            <h6 class="fw-bold mb-3">üìä ƒê∆°n ƒë·∫∑t tour theo tr·∫°ng th√°i thanh to√°n</h6>
            <canvas id="chartDonTrangThai"></canvas>
        </div>
    </div>

    <!-- BI·ªÇU ƒê·ªí S√ìNG -->
    <div class="col-md-6">
        <div class="card shadow-sm p-3 chart-card">
            <h6 class="fw-bold mb-3">üìà Xu h∆∞·ªõng ƒë·∫∑t tour theo ng√†y</h6>
            <canvas id="chartDonTheoNgay"></canvas>
        </div>
    </div>
</div>

<hr class="my-4" />

<h5 class="fw-bold mb-3">üî• Top 3 tour ƒë∆∞·ª£c ƒë·∫∑t nhi·ªÅu nh·∫•t</h5>

<table class="table table-hover align-middle">
    <thead class="table-light">
        <tr>
            <th>Tour</th>
            <th>ƒê·ªãa ƒëi·ªÉm</th>
            <th>S·ªë ng∆∞·ªùi ƒë·∫∑t</th>
            <th>M·ª©c ƒë·ªô hot</th>
        </tr>
    </thead>

@{
    var topTours = ViewBag.TopTour as IEnumerable<dynamic> ?? Enumerable.Empty<dynamic>();
    int max = topTours.Any() ? topTours.Max(t => (int)t.SoNguoiDaDat) : 0;
}

<tbody>
@foreach (var t in topTours)
{
    int percent = max == 0 ? 0 : (int)((double)t.SoNguoiDaDat / max * 100);

    <tr>
        <td>@t.TenTour</td>
        <td>@t.DiaDiem</td>
        <td>
            <span class="badge bg-primary">@t.SoNguoiDaDat ng∆∞·ªùi</span>
        </td>
        <td style="width:30%">
            <div class="progress" style="height:8px;">
                <div class="progress-bar bg-success" style="width:@percent%"></div>
            </div>
        </td>
    </tr>
}
</tbody>
</table>
<script>
    window.soDonDaThanhToan = @ViewBag.SoDonDaThanhToan;
    window.soDonChuaThanhToan = @ViewBag.SoDonChuaThanhToan;
    window.soDonHetHan = @ViewBag.SoDonHetHan;

    window.labelNgay = @Html.Raw(Json.Serialize(ViewBag.LabelNgay));
    window.dataNgay = @Html.Raw(Json.Serialize(ViewBag.DataNgay));
</script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="~/js/dashboard-admin.js"></script>
